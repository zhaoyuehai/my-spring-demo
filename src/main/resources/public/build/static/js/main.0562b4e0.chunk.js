(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{183:function(e,t,a){e.exports=a(414)},390:function(e,t,a){},411:function(e,t,a){},412:function(e,t,a){},413:function(e,t,a){},414:function(e,t,a){"use strict";a.r(t);a(184),a(194);var n=a(1),r=a.n(n),o=a(179),s=a.n(o);a(390),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var l=a(30),i=a(31),c=a(33),d=a(32),u=a(34),m=a(42),h=a.n(m),p=a(83),g=a.n(p),f=a(180),v=a.n(f),b=Object({NODE_ENV:"production",PUBLIC_URL:"."}).REACT_APP_RECPRDS_API_URL||"http://localhost";h.a.interceptors.request.use(function(e){return e.headers.common.Authorization=localStorage.getItem("Authorization"),e},function(e){return Promise.reject(e)}),h.a.interceptors.response.use(function(e){return e},function(e){return e.response&&401===e.response.status&&(localStorage.removeItem("Authorization"),localStorage.removeItem("UserName"),localStorage.removeItem("RoleName"),window.location.reload()),Promise.reject(e)});a(411);var E=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={isLoading:!1,userName:"",password:""},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){var t;(t={})[""+e.target.name]=e.target.value,this.setState(t)}},{key:"valid",value:function(){return!this.state.isLoading&&this.state.userName&&this.state.password}},{key:"handleSubmit",value:function(e){var t,a,n=this;e.preventDefault(),this.setState({isLoading:!0}),(t=this.state.userName,a=this.state.password,h.a.post("".concat(b,"/api/v1/login"),v.a.stringify({username:t,password:g.a.encode(a)}),{headers:{"Content-type":"application/x-www-form-urlencoded",Authorization:null}})).then(function(e){"10000"===e.data.code?(n.setState({isLoading:!1}),n.props.handleLogin(e.data.data)):(alert(e.data.message),n.setState({isLoading:!1}))}).catch(function(e){alert(e.message),n.setState({isLoading:!1})})}},{key:"render",value:function(){return r.a.createElement("form",{id:"LoginForm",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",null,r.a.createElement("input",{type:"text",className:"form-control mb-2",onChange:this.handleChange.bind(this),placeholder:"\u7528\u6237\u540d/\u624b\u673a\u53f7",name:"userName",value:this.state.userName})),r.a.createElement("div",null,r.a.createElement("input",{type:"password",className:"form-control mb-2",onChange:this.handleChange.bind(this),placeholder:"\u5bc6\u7801",name:"password",value:this.state.password})),r.a.createElement("button",{id:"LoginButton",type:"submit",className:"btn btn-primary",disabled:!this.valid()},"\u767b\u5f55"))}}]),t}(n.Component),N=a(182),S=a(181),y=function(e){switch(e){case"ROLE_ADMIN":return"\u7ba1\u7406\u5458";case"ROLE_GUEST":return"\u6e38\u5ba2";case"ROLE_USER":return"\u666e\u901a\u4f1a\u5458";case"ROLE_VIP":return"\u5c0a\u4eab\u4f1a\u5458";default:return"\u672a\u77e5"}},O=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={edit:!1},e}return Object(u.a)(t,e),Object(i.a)(t,[{key:"handleToggle",value:function(){this.setState({edit:!this.state.edit})}},{key:"handleEdit",value:function(e){var t=this;e.preventDefault();var a,n={id:this.props.record.id,userName:this.props.record.userName,phone:this.refs.phone.value,email:this.refs.email.value,nickName:this.refs.nickName.value};(a=n,h.a.put("".concat(b,"/api/v1/user"),a)).then(function(e){"10000"===e.data.code?(t.setState({edit:!1}),t.props.handleEditRecord(t.props.record,n)):alert(e.data.message)})}},{key:"handleDelete",value:function(e){var t,a=this;(t=this.props.record.id,h.a.delete("".concat(b,"/api/v1/user/").concat(t))).then(function(e){"10000"===e.data.code?a.props.handleDeleteRecord(a.props.record.id):alert(e.data.message)})}},{key:"recordRow",value:function(){return r.a.createElement("tr",{key:this.props.record.id},r.a.createElement("td",null,this.props.record.userName),r.a.createElement("td",null,this.props.record.phone),r.a.createElement("td",null,this.props.record.email),r.a.createElement("td",null,this.props.record.nickName),r.a.createElement("td",null,y(this.props.record.roleName)),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-info mr-2",onClick:this.handleToggle.bind(this)},"\u7f16\u8f91"),r.a.createElement("button",{className:"btn btn-danger",onClick:this.handleDelete.bind(this)},"\u5220\u9664")))}},{key:"recordForm",value:function(){return r.a.createElement("tr",null,r.a.createElement("td",null,this.props.record.userName),r.a.createElement("td",null,r.a.createElement("input",{type:"text",className:"form-control",defaultValue:this.props.record.phone,ref:"phone"})),r.a.createElement("td",null,r.a.createElement("input",{type:"text",className:"form-control",defaultValue:this.props.record.email,ref:"email"})),r.a.createElement("td",null,r.a.createElement("input",{type:"text",className:"form-control",defaultValue:this.props.record.nickName,ref:"nickName"})),r.a.createElement("td",null,y(this.props.record.roleName)),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-info mr-2",onClick:this.handleEdit.bind(this)},"\u66f4\u65b0"),r.a.createElement("button",{className:"btn btn-danger",onClick:this.handleToggle.bind(this)},"\u53d6\u6d88")))}},{key:"render",value:function(){return this.state.edit?this.recordForm():this.recordRow()}}]),t}(n.Component),k=(a(412),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={isLoading:!1,userName:"",password:"",phone:""},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"handleChange",value:function(e){var t;(t={})[""+e.target.name]=e.target.value,this.setState(t)}},{key:"valid",value:function(){return!this.state.isLoading&&this.state.userName&&this.state.password&&this.state.phone}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.setState({isLoading:!0});var a,n={id:null,userName:this.state.userName,password:g.a.encode(this.state.password),phone:this.state.phone,roleName:"ROLE_GUEST"};(a=n,h.a.post("".concat(b,"/api/v1/user"),a,{headers:{Authorization:null}})).then(function(e){"10000"===e.data.code?(n.id=e.data.data,t.props.handleNewRecord(n),t.setState({isLoading:!1,userName:"",password:"",phone:""})):(alert(e.data.message),t.setState({isLoading:!1}))}).catch(function(e){alert(e.message),t.setState({isLoading:!1})})}},{key:"render",value:function(){return r.a.createElement("form",{className:"form-inline mt-3 mb-3",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",{className:"form-group mr-2"},r.a.createElement("input",{type:"text",className:"form-control",onChange:this.handleChange.bind(this),placeholder:"\u7528\u6237\u540d",name:"userName",value:this.state.userName})),r.a.createElement("div",{className:"form-group mr-2"},r.a.createElement("input",{type:"password",className:"form-control",onChange:this.handleChange.bind(this),placeholder:"\u5bc6\u7801",name:"password",value:this.state.password})),r.a.createElement("div",{className:"form-group mr-2"},r.a.createElement("input",{type:"text",className:"form-control",onChange:this.handleChange.bind(this),placeholder:"\u624b\u673a\u53f7",name:"phone",value:this.state.phone})),r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:!this.valid()},"\u6ce8\u518c"))}}]),t}(n.Component)),w=function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(c.a)(this,Object(d.a)(t).call(this))).state={error:null,isLoaded:!1,code:null,message:null,data:[]},e}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e,t,a=this;(e=1,t=20,h.a.get("".concat(b,"/api/v1/users?pageNum=").concat(e,"&pageSize=").concat(t))).then(function(e){a.setState({code:e.data.code,message:e.data.message,data:e.data.data,isLoaded:!0})}).catch(function(e){a.setState({isLoaded:!0,error:e})})}},{key:"addRecord",value:function(e){this.setState({error:null,isLoaded:!0,code:"10000",message:"success",data:[].concat(Object(S.a)(this.state.data),[e])})}},{key:"updateRecord",value:function(e,t){var a=this.state.data.indexOf(e),n=this.state.data.map(function(e,n){return n!==a?e:Object(N.a)({},e,t)});this.setState({data:n})}},{key:"deleteRecord",value:function(e){var t=this.state.data.filter(function(t){return t.id!==e});this.setState({data:t})}},{key:"handleSignOut",value:function(e){e.preventDefault(),this.props.handleSignOut()}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.error,o=a.isLoaded,s=a.code,l=a.message,i=a.data;return e=n?r.a.createElement("div",null,"Error:",n.message):o?"10000"===s?r.a.createElement("table",{className:"table table-bordered"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"\u7528\u6237\u540d"),r.a.createElement("th",null,"\u624b\u673a\u53f7"),r.a.createElement("th",null,"\u90ae\u7bb1"),r.a.createElement("th",null,"\u6635\u79f0"),r.a.createElement("th",null,"\u89d2\u8272"),r.a.createElement("th",null,"\u64cd\u4f5c"))),r.a.createElement("tbody",null,i.map(function(e){return r.a.createElement(O,{key:e.id,record:e,handleEditRecord:t.updateRecord.bind(t),handleDeleteRecord:t.deleteRecord.bind(t)})}))):r.a.createElement("div",null,"\u52a0\u8f7d\u5931\u8d25\uff1a",l):r.a.createElement("div",null,"Loading..."),r.a.createElement("div",{className:"m-3"},r.a.createElement("h5",{style:{textAlign:"right"}},r.a.createElement("span",{style:{color:"orange"}}," ",localStorage.getItem("RoleName")," "),"hello,",localStorage.getItem("UserName"),"!  ",r.a.createElement("span",{style:{color:"blue"},onClick:this.handleSignOut.bind(this)},r.a.createElement("u",null,"\u9000\u51fa"))),r.a.createElement("h4",null,"\u65b0\u589e\u7528\u6237"),r.a.createElement(k,{handleNewRecord:this.addRecord.bind(this)}),r.a.createElement("h4",null,"\u7528\u6237\u5217\u8868"),e)}}]),t}(n.Component),L=(a(413),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={isLogin:null!=localStorage.getItem("Authorization")},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"login",value:function(e){localStorage.setItem("Authorization","Bearer "+e.accessToken),localStorage.setItem("UserName",e.userName),localStorage.setItem("RoleName",y(e.roleName)),this.setState({isLogin:!0})}},{key:"signOut",value:function(){localStorage.removeItem("Authorization"),localStorage.removeItem("UserName"),localStorage.removeItem("RoleName"),this.setState({isLogin:!1})}},{key:"render",value:function(){return this.state.isLogin?r.a.createElement("div",null,r.a.createElement(w,{handleSignOut:this.signOut.bind(this)})):r.a.createElement("div",null,r.a.createElement(E,{handleLogin:this.login.bind(this)}))}}]),t}(n.Component));s.a.render(r.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[183,1,2]]]);
//# sourceMappingURL=main.0562b4e0.chunk.js.map